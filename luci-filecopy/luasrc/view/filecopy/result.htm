<%+header%>


<a id="content" name="content"></a>
<%

function encodehtml(str)
	local repl = {
		["<"] = "&lt;",
		["&"] = "&amp;"
	}
	return string.gsub(str,"[<&]", function(c)
		return repl[c] or c
	end)
end

if table.getn(results) == 0 then
-%>
	<p>No results</p>
<% else
	for _,result in ipairs(results) do
	-%>
		<div class="filecopy-result">
			<h2><%=result.fileName%></h2>
			<pre><%=encodehtml(result.contents)%></pre>
			<form method="post" action="<%=luci.dispatcher.build_url("admin", "services", "filecopy", "result_remove")%>">
				<input type="hidden" name="path" value="<%=result.filePath%>" />
				<button class="cbi-button">Delete result</button>
			</form>
		</div>
	<% end -%>
<% end -%>


<script type="text/javascript">//<![CDATA[
	{
		var link = document.createElement("link");
		link.href = "/filecopy.css";
		link.type = "text/css";
		link.rel = "stylesheet";
		document.getElementsByTagName("head")[0].appendChild(link);
	}
//]]></script>

<%+footer%>
